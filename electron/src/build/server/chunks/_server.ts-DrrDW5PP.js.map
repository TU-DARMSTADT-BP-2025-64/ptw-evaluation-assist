{"version":3,"file":"_server.ts-DrrDW5PP.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/login/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../chunks/index2.js\";\nimport { R as Repository } from \"../../../../chunks/repository.js\";\nimport jwt from \"jsonwebtoken\";\nimport dotenv from \"dotenv\";\ndotenv.config();\nasync function POST({ request, cookies }) {\n  const { username, password } = await request.json();\n  const userExists = await Repository.Instance.userExists(username, password);\n  if (userExists) {\n    const token = jwt.sign({ username }, process.env.JWT_SECRET, { expiresIn: \"1h\" });\n    cookies.set(\"session\", token, {\n      path: \"/\",\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\" || process.env.NODE_ENV === \"test\",\n      sameSite: \"strict\",\n      maxAge: 3600\n    });\n    return json({ success: true });\n  }\n  return json({ success: false, message: \"Invalid credentials\" }, { status: 401 });\n}\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;AAIA,MAAM,CAAC,MAAM,EAAE;AACf,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,EAAE;AAC1C,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AACrD,EAAE,MAAM,UAAU,GAAG,MAAM,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC;AAC7E,EAAE,IAAI,UAAU,EAAE;AAClB,IAAI,MAAM,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;AACrF,IAAI,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,KAAK,EAAE;AAClC,MAAM,IAAI,EAAE,GAAG;AACf,MAAM,QAAQ,EAAE,IAAI;AACpB,MAAM,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,MAAM;AACtF,MAAM,QAAQ,EAAE,QAAQ;AACxB,MAAM,MAAM,EAAE;AACd,KAAK,CAAC;AACN,IAAI,OAAO,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;AAClC;AACA,EAAE,OAAO,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,qBAAqB,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AAClF;;;;"}